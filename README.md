# LangGraph Transparent Proxy (FastAPI)

This service is a transparent proxy in front of a LangGraph API server.

The goal is full API passthrough so `agent-chat-ui` can point to this service
without changing its request paths.

## Environment variables

- `LANGGRAPH_UPSTREAM_URL` (default: `http://127.0.0.1:8123`)
- `LANGGRAPH_UPSTREAM_API_KEY` (optional, injected as `x-api-key` to upstream)
- `PROXY_TIMEOUT_SECONDS` (default: `300`)
- `PROXY_CORS_ALLOW_ORIGINS` (default: `*`, comma-separated)
- `PROXY_UPSTREAM_RETRIES` (default: `1`)
- `PROXY_LOG_LEVEL` (default: `INFO`)
- `RUNTIME_ROLE_ENFORCEMENT_ENABLED` (default: `false`, blocks runtime write methods for `member` role when tenant context exists)
- `PLATFORM_DB_ENABLED` (default: `false`)
- `PLATFORM_DB_AUTO_CREATE` (default: `false`)
- `REQUIRE_TENANT_CONTEXT` (default: `false`)
- `DATABASE_URL` (required when `PLATFORM_DB_ENABLED=true`)
- `KEYCLOAK_AUTH_ENABLED` (default: `false`)
- `KEYCLOAK_AUTH_REQUIRED` (default: `false`)
- `KEYCLOAK_ISSUER` (required when `KEYCLOAK_AUTH_ENABLED=true`)
- `KEYCLOAK_AUDIENCE` (optional but recommended)
- `KEYCLOAK_JWKS_URL` (optional, defaults to `<issuer>/protocol/openid-connect/certs`)
- `KEYCLOAK_JWKS_CACHE_TTL_SECONDS` (default: `300`)
- `OPENFGA_ENABLED` (default: `false`)
- `OPENFGA_AUTHZ_ENABLED` (default: `false`)
- `OPENFGA_AUTO_BOOTSTRAP` (default: `false`)
- `OPENFGA_URL` (default: `http://127.0.0.1:18081`)
- `OPENFGA_STORE_ID` (optional, generated by setup script)
- `OPENFGA_MODEL_ID` (optional, generated by setup script)

## Run

```bash
uv run uvicorn main:app --host 0.0.0.0 --port 2024 --reload
```

## Health check

```bash
curl http://127.0.0.1:2024/_proxy/health
```

## Notes

- All incoming paths and methods are forwarded as-is.
- Status code and response headers are preserved (except hop-by-hop headers).
- SSE and long responses are streamed through directly.

## Docs

- `docs/README.md`
- `docs/platform-plan.md`
- `docs/execution-status.md`
- `docs/postgres-operations.md`
- `docs/code-architecture.md`
- `docs/keycloak-integration.md`
- `docs/platform-api.md`
- `docs/openfga-integration.md`
